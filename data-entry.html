<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>工作数据录入 - 声度星主持</title>
    <script src="lib/tailwind.js"></script>
    <script src="lib/vue.global.js"></script>
    <script src="lib/dayjs.min.js"></script>
    <!-- Auth Guard -->
    <script src="auth-guard.js?v=2026-02-13"></script>
    
    <!-- Libraries -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    
    <script>
        // Check if Vue is loaded
        window.addEventListener('load', () => {
            if (typeof Vue === 'undefined') {
                console.error('Vue 资源加载失败，请检查 lib 目录。');
            }
        });
    </script>
    <style>
        [v-cloak] { display: none !important; }
        /* Ensure modal is hidden before Vue loads */
        #app[v-cloak] [v-show], #app[v-cloak] [v-if] { display: none !important; }
        .table-container { overflow-x: auto; -webkit-overflow-scrolling: touch; }
        .data-table th { white-space: nowrap; font-size: 10px; font-weight: 800; color: #64748b; text-transform: uppercase; letter-spacing: 0.02em; padding: 10px 4px; border-bottom: 1px solid #e2e8f0; background: #f8fafc; text-align: center; }
        .data-table td { padding: 6px 4px; border-bottom: 1px solid #f1f5f9; font-size: 12px; text-align: center; }
        .input-cell { width: 65px; text-align: center; border: 1px solid transparent; border-radius: 4px; padding: 4px 2px; transition: all 0.2s; background: transparent; font-weight: 600; color: #1e293b; font-size: 12px; }
        .input-cell:hover:not(:disabled) { border-color: #cbd5e1; background: #fff; }
        .input-cell:focus { border-color: #3b82f6; background: #fff; outline: none; box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1); }
        .input-cell:disabled { color: #94a3b8; cursor: not-allowed; font-weight: normal; }
        .summary-row { background-color: #f1f5f9; }
        .child-row { background-color: #fff; }
        .grand-total-row { background-color: #7f1d1d; color: white; }
        .grand-total-row td { border-bottom: none; font-weight: 900; }
        .grand-total-row .input-cell { color: white; }
        
        /* Mobile Adaptations */
        @media (max-width: 768px) {
            aside { transform: translateX(-100%); transition: transform 0.3s ease; width: 260px; }
            aside.mobile-active { transform: translateX(0); }
            main { margin-left: 0 !important; }
            .header-content { padding-left: 1rem; padding-right: 1rem; }
            .table-section { padding: 1rem !important; }
            .data-table th, .data-table td { padding: 8px 10px; font-size: 12px; }
            .input-cell { width: 65px !important; padding: 4px 2px !important; }
        }

        /* 隐藏数字输入框默认的上下调节按钮 */
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        input[type=number] {
            -moz-appearance: textfield;
        }
        /* Date Picker Popover */
        .datepicker-popover {
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            margin-top: 0.5rem;
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 1rem;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            width: 280px;
            z-index: 100;
            padding: 1.25rem;
            animation: popover-in 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes popover-in {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .month-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .month-btn {
            padding: 0.6rem 0.4rem;
            text-align: center;
            border-radius: 0.75rem;
            font-size: 0.75rem;
            font-weight: 600;
            transition: all 0.2s;
            border: 1px solid transparent;
            color: #64748b;
        }

        .month-btn:hover {
            background: #f1f5f9;
            color: #2563eb;
        }

        .month-btn.active {
            background: #eff6ff;
            color: #2563eb;
            border-color: #bfdbfe;
        }

        .year-tab-container {
            display: flex;
            background: #f1f5f9;
            padding: 3px;
            border-radius: 10px;
            margin-bottom: 1rem;
        }

        .year-tab {
            flex: 1;
            padding: 6px;
            text-align: center;
            font-size: 12px;
            font-weight: 700;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            color: #64748b;
        }

        .year-tab.active {
            background: white;
            color: #2563eb;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-900 font-sans">
    <div id="app" v-cloak class="min-h-screen flex">
        <!-- Sidebar Navigation -->
        <aside :class="['w-48 bg-white border-r border-slate-200 flex flex-col fixed left-0 top-0 h-screen z-50', isMobileMenuOpen ? 'mobile-active' : '']">
            <div class="p-6 border-b border-slate-100 flex items-center justify-between">
                <div class="flex items-center gap-2.5">
                    <div class="bg-amber-500 p-1.5 rounded-lg shrink-0">
                        <i data-lucide="file-text" class="w-4 h-4 text-white"></i>
                    </div>
                    <h1 class="font-bold text-lg tracking-tight text-slate-800">工作数据</h1>
                </div>
                <!-- Close Mobile Menu -->
                <button @click="isMobileMenuOpen = false" class="md:hidden p-2 text-slate-400 hover:text-slate-600">
                    <i data-lucide="x" class="w-6 h-6"></i>
                </button>
            </div>
            
            <nav class="flex-grow p-4 space-y-1.5 overflow-y-auto">
                <a href="index.html" class="w-full flex items-center gap-3 px-3 py-2.5 rounded-xl text-[13px] font-bold transition-all text-slate-600 hover:bg-slate-50">
                    <i data-lucide="layout-dashboard" class="w-4 h-4"></i>
                    仪表盘
                </a>
                <div class="w-full flex items-center gap-3 px-3 py-2.5 rounded-xl text-[13px] font-bold transition-all bg-amber-50 text-amber-600 shadow-sm">
                    <i data-lucide="edit-3" class="w-4 h-4"></i>
                    工作数据
                </div>
                <a href="performance.html" class="w-full flex items-center gap-3 px-3 py-2.5 rounded-xl text-[13px] font-bold transition-all text-slate-600 hover:bg-slate-50">
                    <i data-lucide="check-square" class="w-4 h-4"></i>
                    绩效考核
                </a>
                <a href="salary-calculation.html" class="w-full flex items-center gap-3 px-3 py-2.5 rounded-xl text-[13px] font-bold transition-all text-slate-600 hover:bg-slate-50">
                    <i data-lucide="banknote" class="w-4 h-4"></i>
                    工资计算
                </a>
            </nav>

            <div class="p-4 border-t border-slate-100">
                <button @click="exportToCSV" class="w-full bg-slate-900 text-white px-4 py-2.5 rounded-xl font-bold text-[12px] hover:bg-slate-800 transition-all flex items-center justify-center gap-2">
                    <i data-lucide="download" class="w-3.5 h-3.5"></i>
                    导出报表
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-grow flex flex-col min-w-0 ml-48 relative">
            <!-- Mobile Header -->
            <div class="md:hidden bg-white border-b border-slate-200 px-4 py-3 flex items-center justify-between sticky top-0 z-40">
                <button @click="isMobileMenuOpen = true" class="p-2 -ml-2 text-slate-600">
                    <i data-lucide="menu" class="w-6 h-6"></i>
                </button>
                <h1 class="font-bold text-slate-800">工作数据</h1>
                <div class="w-10"></div> <!-- Spacer -->
            </div>

            <!-- Header -->
            <header class="bg-white/80 backdrop-blur-md border-b border-slate-200 px-8 py-4 flex flex-col md:flex-row md:items-center justify-between sticky top-0 md:top-0 z-30 header-content">
                <div class="flex flex-col md:flex-row md:items-center gap-4 md:gap-6 mb-4 md:mb-0">
                    <div class="flex items-center justify-between">
                        <h2 class="text-xl font-black text-slate-800 tracking-tight">月度工作数据</h2>
                    </div>
                    
                    <!-- Unified Date Picker -->
                    <div class="relative">
                        <button @click="showDatePicker = !showDatePicker" 
                                class="flex items-center gap-2 px-3 py-1.5 bg-slate-50 rounded-lg border border-slate-200 hover:bg-slate-100 transition-all group">
                            <i data-lucide="calendar" class="w-4 h-4 text-slate-400 group-hover:text-blue-500"></i>
                            <span class="text-sm font-bold text-slate-700">
                                {{ currentMonth.split('-')[0] }}年{{ currentMonth.split('-')[1] }}月
                            </span>
                            <i data-lucide="chevron-down" :class="['w-3 h-3 text-slate-400 transition-transform duration-200', showDatePicker ? 'rotate-180' : '']"></i>
                        </button>
                        
                        <!-- Date Picker Popover -->
                        <div v-if="showDatePicker" v-cloak class="datepicker-popover">
                            <div class="year-tab-container">
                                <div v-for="y in ['2025', '2026']" :key="y"
                                     @click="pickerTempYear = y"
                                     :class="['year-tab', pickerTempYear === y ? 'active' : '']">
                                    {{y}}年
                                </div>
                            </div>
                            
                            <div class="month-grid">
                                <button v-for="m in 12" :key="m"
                                        @click="selectMonth(pickerTempYear, m)"
                                        :class="['month-btn', currentMonth === `${pickerTempYear}-${String(m).padStart(2, '0')}` ? 'active' : '']">
                                    {{m}}月
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="flex items-center justify-between md:justify-end gap-3">
                    <!-- Sync Button (Changed to Import) -->
                    <button @click="initData(true)" class="flex items-center gap-2 px-4 py-1.5 bg-white border border-slate-200 rounded-lg text-sm font-bold text-blue-600 hover:bg-blue-50 transition-all shadow-sm group">
                        <i data-lucide="refresh-cw" class="w-4 h-4 group-hover:rotate-180 transition-transform duration-500"></i>
                        <span class="hidden sm:inline">从系统同步最新明细</span>
                        <span class="sm:hidden">同步</span>
                    </button>

                    <!-- History Button -->
                    <button @click="showHistory = true" class="flex items-center gap-2 px-4 py-1.5 bg-white border border-slate-200 rounded-lg text-sm font-bold text-slate-600 hover:bg-slate-50 transition-all shadow-sm">
                        <i data-lucide="history" class="w-4 h-4"></i>
                        <span class="hidden sm:inline">历史记录</span>
                        <span class="sm:hidden">历史</span>
                    </button>

                    <!-- Save Status -->
                    <div class="flex items-center gap-2 px-3 py-1 rounded-full text-xs font-bold transition-all w-fit"
                         :class="{
                             'bg-slate-100 text-slate-400': !saveStatus,
                             'bg-blue-50 text-blue-600': saveStatus === 'saving',
                             'bg-green-50 text-green-600': saveStatus === 'saved',
                             'bg-red-50 text-red-600': saveStatus === 'error'
                         }">
                        <div v-if="saveStatus === 'saving'" class="w-2 h-2 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"></div>
                        <div v-else class="w-2 h-2 rounded-full" 
                             :class="{
                                 'bg-slate-300': !saveStatus,
                                 'bg-green-500': saveStatus === 'saved',
                                 'bg-red-500': saveStatus === 'error'
                             }"></div>
                        <span class="whitespace-nowrap">{{ saveStatus === 'saving' ? '保存中...' : (saveStatus === 'saved' ? '已保存' : (saveStatus === 'error' ? '失败' : '自动保存')) }}</span>
                    </div>
                </div>
            </header>

            <!-- Table Section -->
            <div class="p-4 lg:p-6">
                <div class="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden">
                    <div class="table-container">
                        <table class="data-table w-full text-left border-collapse">
                            <thead>
                                <tr>
                                    <th v-for="col in columns" :key="col.key" :style="{ width: col.width || (col.key === 'name' ? '140px' : 'auto') }">
                                        {{ col.label }}
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Special Case: 小花老师 Summary & Children -->
                                <template v-for="id in ['小花老师', 'xh_la', 'xh_ch']" :key="id">
                                    <tr v-if="tableData[id] && (tableData[id].isSummary || expandedRows['小花老师'])" 
                                        :class="tableData[id].isSummary ? 'summary-row' : 'child-row'">
                                        <td v-for="col in columns" :key="col.key">
                                            
                                            <!-- Name Column -->
                                            <div v-if="col.key === 'name'" class="flex items-center gap-2 px-2">
                                                <div v-if="tableData[id].isSummary" 
                                                     @click="expandedRows['小花老师'] = !expandedRows['小花老师']"
                                                     class="flex items-center gap-2 cursor-pointer group">
                                                    <div class="w-1.5 h-1.5 rounded-full bg-blue-600"></div>
                                                    <span class="font-black text-slate-900 whitespace-nowrap">{{ tableData[id].name }}</span>
                                                    <i data-lucide="chevron-down" :class="['w-3.5 h-3.5 text-slate-400 transition-transform duration-200', expandedRows['小花老师'] ? 'rotate-180' : '']"></i>
                                                </div>
                                                <div v-else class="flex items-center gap-2 ml-4">
                                                    <div class="w-4 h-px bg-slate-300"></div>
                                                    <span class="text-slate-600 font-bold whitespace-nowrap">{{ tableData[id].name }}</span>
                                                </div>
                                            </div>

                                            <!-- Number Input -->
                                            <template v-else-if="col.type === 'number'">
                                                <!-- Summary or Disabled: Display formatted text -->
                                                <span v-if="tableData[id].isSummary || (tableData[id].isTeachingDisabled && teachingColumns.includes(col.key))"
                                                      class="font-bold text-slate-700">
                                                    {{ tableData[id].isTeachingDisabled && teachingColumns.includes(col.key) ? '/' : (col.decimals !== undefined ? Number(tableData[id][col.key] || 0).toFixed(col.decimals) : tableData[id][col.key]) }}
                                                </span>
                                                <!-- Editable: Input field -->
                                                <input v-else
                                                       type="number"
                                                       v-model.number="tableData[id][col.key]"
                                                       @input="handleInputChange(id, col.key)"
                                                       :step="col.decimals === 2 ? '0.01' : (col.decimals === 1 ? '0.1' : '1')"
                                                       class="input-cell"
                                                       placeholder="0">
                                            </template>

                                            <!-- Formula Display -->
                                            <span v-else-if="col.type === 'formula'" class="font-bold"
                                                  :class="tableData[id].isTeachingDisabled && teachingColumns.includes(col.key) ? 'text-slate-300' : 'text-blue-600'">
                                                {{ tableData[id].isTeachingDisabled && teachingColumns.includes(col.key) ? '/' : col.formula(tableData[id]) }}
                                            </span>

                                            <!-- Special Case for 小草老师 / disabled columns -->
                                            <span v-else-if="tableData[id].isTeachingDisabled && teachingColumns.includes(col.key)" class="text-slate-300">/</span>
                                        </td>
                                    </tr>
                                </template>

                                <!-- Other Teachers -->
                                <template v-for="id in ['tz', 'yz', 'xc']" :key="id">
                                    <tr v-if="tableData[id]">
                                        <td v-for="col in columns" :key="col.key">
                                            
                                            <!-- Name Column -->
                                            <div v-if="col.key === 'name'" class="flex items-center gap-2 px-2">
                                                <div class="w-1.5 h-1.5 rounded-full bg-slate-400"></div>
                                                <span class="font-black text-slate-800 whitespace-nowrap">{{ tableData[id].name }}</span>
                                            </div>

                                            <!-- Number Input -->
                                            <template v-else-if="col.type === 'number'">
                                                <!-- Summary or Disabled: Display formatted text -->
                                                <span v-if="tableData[id].isTeachingDisabled && teachingColumns.includes(col.key)"
                                                      class="font-bold text-slate-700">
                                                    /
                                                </span>
                                                <!-- Editable: Input field -->
                                                <input v-else
                                                       type="number"
                                                       v-model.number="tableData[id][col.key]"
                                                       @input="handleInputChange(id, col.key)"
                                                       :step="col.decimals === 2 ? '0.01' : (col.decimals === 1 ? '0.1' : '1')"
                                                       class="input-cell"
                                                       placeholder="0">
                                            </template>

                                            <!-- Formula Display -->
                                            <span v-else-if="col.type === 'formula'" class="font-bold"
                                                  :class="tableData[id].isTeachingDisabled && teachingColumns.includes(col.key) ? 'text-slate-300' : 'text-blue-600'">
                                                {{ tableData[id].isTeachingDisabled && teachingColumns.includes(col.key) ? '/' : col.formula(tableData[id]) }}
                                            </span>
                                        </td>
                                    </tr>
                                </template>

                                <!-- Grand Total Row -->
                                <tr class="grand-total-row">
                                    <td v-for="col in columns" :key="col.key">
                                        <span v-if="col.key === 'name'" class="tracking-[0.2em]">汇总</span>
                                        <span v-else-if="col.type === 'number'">{{ col.decimals !== undefined ? Number(grandTotal[col.key] || 0).toFixed(col.decimals) : grandTotal[col.key] }}</span>
                                        <span v-else-if="col.type === 'formula'">{{ col.formula(grandTotal) }}</span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Legend / Notes -->
                <div class="mt-8 grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="bg-amber-50 border border-amber-100 rounded-xl p-5">
                        <h4 class="text-amber-800 font-bold text-sm mb-2 flex items-center gap-2">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                            录入说明
                        </h4>
                        <p class="text-amber-700 text-xs leading-relaxed">
                            1. <strong>小花老师</strong>的数据由下方两个校区自动汇总，请直接修改校区数据。<br>
                            2. <strong>小草老师</strong>不涉及授课任务，相关单元格已标记为 "/"。<br>
                            3. 所有数据实时保存至本地，刷新页面不会丢失。
                        </p>
                    </div>
                    <div class="bg-blue-50 border border-blue-100 rounded-xl p-5">
                        <h4 class="text-blue-800 font-bold text-sm mb-2 flex items-center gap-2">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path></svg>
                            计算逻辑
                        </h4>
                        <p class="text-blue-700 text-xs leading-relaxed">
                            - <strong>试听转化率</strong> = 报课人数 / 上课人数<br>
                            - <strong>总业绩</strong> = 新签业绩 + 续费业绩<br>
                            - <strong>出勤率</strong> = 出勤 / (出勤 + 缺勤 + 请假)
                        </p>
                    </div>
                    <div class="bg-slate-100 border border-slate-200 rounded-xl p-5">
                        <h4 class="text-slate-800 font-bold text-sm mb-2 flex items-center gap-2">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
                            数据导出
                        </h4>
                        <p class="text-slate-600 text-xs leading-relaxed">
                            点击左侧“导出报表”可将当前数据导出为 CSV 格式，支持使用 Excel 或 WPS 打开进一步编辑和存档。
                        </p>
                    </div>
                </div>
            </div>
        </main>

        <!-- History Modal -->
        <div v-show="showHistory" class="fixed inset-0 z-[100] items-center justify-center p-4 bg-slate-900/40 backdrop-blur-sm" @click.self="showHistory = false">
            <div class="bg-white rounded-3xl shadow-2xl w-full max-w-2xl max-h-[85vh] flex flex-col overflow-hidden animate-popover-in">
                <!-- Modal Header -->
                <div class="px-8 py-6 border-b border-slate-100 flex items-center justify-between">
                    <div>
                        <h3 class="text-xl font-black text-slate-800 tracking-tight">历史记录管理</h3>
                        <p class="text-slate-400 text-xs mt-1 font-bold">{{ currentMonth }} 月份的数据版本</p>
                    </div>
                    <button @click="showHistory = false" class="p-2 hover:bg-slate-50 rounded-xl transition-all text-slate-400 hover:text-slate-600">
                        <i data-lucide="x" class="w-6 h-6"></i>
                    </button>
                </div>

                <!-- Modal Content -->
                <div class="flex-grow overflow-y-auto p-8">
                    <!-- Save Current Section -->
                    <div class="bg-blue-50/50 rounded-2xl p-6 mb-8 border border-blue-100/50">
                        <h4 class="text-sm font-black text-blue-800 mb-4 flex items-center gap-2">
                            <i data-lucide="plus-circle" class="w-4 h-4"></i>
                            保存当前数据为新版本
                        </h4>
                        <div class="flex gap-3">
                            <input v-model="historyNote" type="text" placeholder="输入版本备注（如：截图备份、系统导出...）" 
                                   class="flex-grow bg-white border border-blue-200 rounded-xl px-4 py-2.5 text-sm font-bold focus:outline-none focus:ring-4 focus:ring-blue-100 transition-all">
                            <button @click="saveHistoryRecord(false)" 
                                    class="bg-blue-600 text-white px-6 py-2.5 rounded-xl font-black text-sm hover:bg-blue-700 transition-all shadow-lg shadow-blue-200 shrink-0">
                                保存版本
                            </button>
                        </div>
                    </div>

                    <!-- Records List -->
                    <div class="space-y-4">
                        <div v-if="historyRecords.length === 0" class="text-center py-12">
                            <div class="w-16 h-16 bg-slate-50 rounded-full flex items-center justify-center mx-auto mb-4">
                                <i data-lucide="clock" class="w-8 h-8 text-slate-300"></i>
                            </div>
                            <p class="text-slate-400 font-bold">暂无历史记录</p>
                        </div>
                        
                        <div v-for="record in historyRecords" :key="record.id" 
                             :class="['group flex items-center justify-between p-4 rounded-2xl border transition-all', 
                                     currentVersionId === record.id ? 'bg-blue-50/30 border-blue-200' : 'bg-white border-slate-100 hover:border-blue-200 hover:shadow-md']">
                            <div class="flex items-center gap-4">
                                <div :class="['w-10 h-10 rounded-xl flex items-center justify-center shrink-0', 
                                            currentVersionId === record.id ? 'bg-blue-600 text-white' : 'bg-slate-100 text-slate-400 group-hover:bg-blue-100 group-hover:text-blue-600']">
                                    <i :data-lucide="record.id.toString().startsWith('system') ? 'cpu' : (record.id.toString().startsWith('ocr') ? 'scan' : 'file-text')" class="w-5 h-5"></i>
                                </div>
                                <div>
                                    <div class="flex items-center gap-2">
                                        <span class="font-black text-slate-800">{{ record.note }}</span>
                                        <span v-if="currentVersionId === record.id" class="px-2 py-0.5 bg-blue-600 text-white text-[10px] font-black rounded-full">当前使用</span>
                                    </div>
                                    <p class="text-slate-400 text-xs mt-0.5 font-bold">{{ record.displayTime }}</p>
                                </div>
                            </div>
                            
                            <div class="flex items-center gap-2">
                                <button v-if="currentVersionId !== record.id" @click="loadVersion(record)" 
                                        class="px-4 py-2 bg-slate-100 text-slate-600 rounded-xl text-xs font-black hover:bg-blue-600 hover:text-white transition-all">
                                    还原
                                </button>
                                <button v-if="!record.id.toString().startsWith('system')" @click="deleteVersion(record.id)" 
                                        class="p-2 text-slate-300 hover:text-red-500 hover:bg-red-50 rounded-xl transition-all">
                                    <i data-lucide="trash-2" class="w-4 h-4"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="data-consumption-2025.js"></script>
     <script src="data-consumption-2026.js"></script>
     <script src="data-experience-2025.js"></script>
     <script src="data-experience-2026.js"></script>
     <script src="data-2025.js"></script>
     <script src="data-2026.js"></script>
     <script src="preset-data.js"></script>
     <script src="data-entry.js"></script>
</body>
</html>
